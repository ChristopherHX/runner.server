(this["webpackJsonpreact-master-detail"]=this["webpackJsonpreact-master-detail"]||[]).push([[0],{20:function(e,t,n){e.exports={component:"MasterDetail_component__Uz_TT",master:"MasterDetail_master__25jd3",detail:"MasterDetail_detail__1_NEc"}},22:function(e,t,n){e.exports={header:"Header_header__Nww_e",back:"Header_back__2pYLZ"}},25:function(e,t,n){e.exports={component:"ListItem_component__1tRbh",inner:"ListItem_inner__3kPOv"}},26:function(e,t,n){e.exports={component:"ListItemLink_component__5N6-o",active:"ListItemLink_active__14SJk"}},41:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(32),r=n.n(c),s=(n(41),n(9)),o=n(4),l=n(19),u="(max-width: 599px)",d=n(22),b=n.n(d),j=n(1),p=function(e){return Object(j.jsxs)("div",{className:b.a.header,children:[Object(j.jsx)(l.a,{query:u,children:function(t){return t?Object(j.jsx)(s.b,{to:"../../",className:b.a.back,style:{visibility:e.hideBackButton?"hidden":"visible"},children:"Back"}):Object(j.jsx)("div",{children:"\xa0"})}}),Object(j.jsx)("h1",{"data-test":"HeaderTitle",children:e.title||"No Title"})]})};p.defaultProps={hideBackButton:!1};var m=n(25),_=n.n(m),x="No Data",h=function(e){return Object(j.jsx)("div",{className:_.a.component,children:Object(j.jsxs)("div",{className:_.a.inner,children:[Object(j.jsx)("h1",{"data-test":"ListItemHeading",children:e.item.title?e.item.title:x}),Object(j.jsx)("h2",{"data-test":"ListItemSubHeading",children:e.item.description?e.item.description:x})]})})},f=n(12),O=n(26),v=n.n(O),g=function(e){return Object(j.jsx)(s.c,{exact:!0,to:e.to,className:v.a.component,activeClassName:v.a.active,children:Object(j.jsx)(h,Object(f.a)({},e))})},w=n(20),I=n.n(w),N=function(e){var t=Object(o.h)().path,n=Object(j.jsx)(e.MasterType,Object(f.a)(Object(f.a)({},e.masterProps),{},{"data-test":"Master"})),a=Object(j.jsx)(e.DetailType,Object(f.a)(Object(f.a)({},e.detailProps),{},{"data-test":"Detail"}));return Object(j.jsx)(l.a,{query:u,children:function(e){return e?Object(j.jsxs)(o.d,{children:[Object(j.jsx)(o.b,{exact:!0,path:"".concat(t),children:n}),Object(j.jsx)(o.b,{path:"".concat(t,"/detail/:id"),children:a})]}):Object(j.jsxs)("section",{className:I.a.component,children:[Object(j.jsx)("section",{className:I.a.master,children:Object(j.jsx)(o.b,{path:"".concat(t),children:n})}),Object(j.jsx)("section",{className:I.a.detail,children:Object(j.jsxs)(o.d,{children:[Object(j.jsx)(o.b,{exact:!0,path:"".concat(t),children:a}),Object(j.jsx)(o.b,{path:"".concat(t,"/detail/:id"),children:a})]})})]})}})},k=n(18),L=n(10),C=n.n(L),T=n(35),y=n(16),D=n(14),S=function(e,t){var n="string"===typeof t?parseInt(t,10):t;if(void 0!==n&&null!==n){var a=e.find((function(e,t,a){return e.RequestId===n}))||null;if(null!==a)return{item:{id:a.RequestId,title:a.JobId,description:a.TimeLineId}}}return{item:null}},J=n(8),M=n.n(J),q=n(27),E=n.n(q),H=n(36),B=n.n(H),R=function(e){var t=Object(a.useState)([]),n=Object(D.a)(t,2),i=n[0],c=n[1],r=Object(a.useState)([]),s=Object(D.a)(r,2),l=s[0],u=s[1],d=Object(a.useState)("Loading..."),b=Object(D.a)(d,2),m=b[0],_=b[1],x=Object(o.g)().id,h=Object(o.g)(),f=h.owner,O=h.repo;return Object(a.useEffect)((function(){Object(y.a)(C.a.mark((function e(){var t,n,a,r,s,o,l,d,b,j;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==x){e.next=2;break}return e.abrupt("return");case 2:if(n=Number.parseInt(x),0!==i.length&&null!=i.find((function(e){return e.RequestId===n}))){e.next=10;break}return e.next=6,fetch("/"+f+"/"+O+"/_apis/v1/Message",{});case 6:return e.next=8,e.sent.json();case 8:t=e.sent,c(t);case 10:if(a=S(t||i,x).item,null==(r=a?a.description:null)){e.next=58;break}return e.next=15,fetch("/"+f+"/"+O+"/_apis/v1/Timeline/"+r,{});case 15:return e.next=17,e.sent.json();case 17:if(!(null!=(s=e.sent)&&s.length>1)){e.next=57;break}_(s.shift().name),o=new E.a({newline:!0}),l=Object(T.a)(s),e.prev=22,l.s();case 24:if((d=l.n()).done){e.next=49;break}if(null===(b=d.value).log||-1===b.log.id){e.next=35;break}return e.next=29,fetch("/"+f+"/"+O+"/_apis/v1/Logfiles/"+b.log.id,{});case 29:return e.next=31,e.sent.text();case 31:j=e.sent,b.log.content=o.toHtml(j),e.next=47;break;case 35:return e.prev=35,e.t0=-1,e.next=39,fetch("/"+f+"/"+O+"/_apis/v1/TimeLineWebConsoleLog/"+r+"/"+b.id,{});case 39:return e.next=41,e.sent.json();case 41:e.t1=e.sent.reduce((function(e,t){return e+"<br/>"+o.toHtml(t.line)}),""),b.log={id:e.t0,location:null,content:e.t1},e.next=47;break;case 45:e.prev=45,e.t2=e.catch(35);case 47:e.next=24;break;case 49:e.next=54;break;case 51:e.prev=51,e.t3=e.catch(22),l.e(e.t3);case 54:return e.prev=54,l.f(),e.finish(54);case 57:u(s);case 58:case"end":return e.stop()}}),e,null,[[22,51,54,57],[35,45]])})))()}),[x,i,f,O]),Object(a.useEffect)((function(){if(void 0!==x&&null!==x&&x.length>0){var e=S(i,x).item;if(null!==e){var t=new EventSource(NaN+f+"/"+O+"/_apis/v1/TimeLineWebConsoleLog?timelineId="+e.description);return t.addEventListener("log",(function(e){console.log("new logline "+e.data);var t=JSON.parse(e.data);u((function(e){var n=e.find((function(e){return e.id===t.record.StepId})),a=new E.a({newline:!0,escapeXML:!0});return null!=n?(null==n.log&&(n.log={id:-1,location:null,content:""}),-1===n.log.id&&(n.log.content=t.record.Value.reduce((function(e,t){return e+"<br/>"+a.toHtml(t)}),n.log.content))):Object(y.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))(),Object(k.a)(e)}))})),function(){t.close()}}}return function(){}}),[x,i,f,O]),Object(j.jsxs)("section",{className:M.a.component,children:[Object(j.jsx)(p,{title:m}),Object(j.jsx)("main",{className:M.a.main,children:Object(j.jsx)("div",{className:M.a.text,style:{width:"100%"},children:l.map((function(e){return Object(j.jsx)(B.a,{className:M.a.Collapsible,openedClassName:M.a.Collapsible,triggerClassName:M.a.Collapsible__trigger,triggerOpenedClassName:M.a.Collapsible__trigger+" "+M.a["is-open"],contentOuterClassName:M.a.Collapsible__contentOuter,contentInnerClassName:M.a.Collapsible__contentInner,trigger:e.name,children:Object(j.jsx)("div",{style:{textAlign:"left",whiteSpace:"nowrap",maxHeight:"100%",overflow:"auto"},dangerouslySetInnerHTML:{__html:null!=e.log?e.log.content:"Nothing here"}})},x+e.id)}))})})]})},P=function(e){var t=Object(o.h)().url,n=Object(a.useState)({items:[]}),c=Object(D.a)(n,2),r=c[0],s=c[1],l=Object(o.g)(),u=l.owner,d=l.repo;return Object(a.useEffect)((function(){var e="/"+u+"/"+d+"/_apis/v1/Message";Object(y.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.t1=JSON,t.next=4,fetch(e,{});case 4:return t.next=6,t.sent.text();case 6:t.t2=t.sent,t.t3=t.t1.parse.call(t.t1,t.t2).sort((function(e,t){return t.RequestId-e.RequestId})).map((function(e){return{id:e.RequestId,title:e.JobId,description:e.TimeLineId}})),t.t4={items:t.t3},(0,t.t0)(t.t4);case 10:case"end":return t.stop()}}),t)})))(),new EventSource("/"+u+"/"+d+"/_apis/v1/Message/event").addEventListener("job",(function(e){var t=JSON.parse(e.data).job;s((function(e){return{items:[{id:t.RequestId,title:t.JobId,description:t.TimeLineId}].concat(Object(k.a)(e.items))}}))}))}),[u,d]),Object(j.jsxs)(i.a.Fragment,{children:[Object(j.jsx)(p,{title:"Jobs",hideBackButton:!0}),Object(j.jsx)("ul",{children:r.items.map((function(e){return Object(j.jsx)("li",{children:Object(j.jsx)(g,{to:"".concat(t,"/detail/").concat(e.id),item:e})},e.id)}))})]})},W=function(){return Object(j.jsx)(s.a,{children:Object(j.jsxs)(o.d,{children:[Object(j.jsx)(o.b,{path:"/master/:owner/:repo",render:function(e){return Object(j.jsx)(N,{MasterType:P,masterProps:{},DetailType:R,detailProps:{}})}}),Object(j.jsx)(o.a,{exact:!0,from:"/",to:"/master/runner/server"})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(j.jsx)(W,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports={component:"Detail_component__1-q_u",main:"Detail_main__2xXle",Collapsible:"Detail_Collapsible__2slk1",Collapsible__contentInner:"Detail_Collapsible__contentInner__3s9IG",Collapsible__trigger:"Detail_Collapsible__trigger__O7Wcx","is-open":"Detail_is-open__2vygp","is-disabled":"Detail_is-disabled__2L3mn","Collapsible__custom-sibling":"Detail_Collapsible__custom-sibling__1TuEJ"}}},[[56,1,2]]]);
//# sourceMappingURL=main.51110c70.chunk.js.map